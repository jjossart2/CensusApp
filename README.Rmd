---
title: "midterm"
author: "Karl Rohe"
output: md_document
---
  
  
## Midterm.
  
#### 1.  Map the delay by destination.
  
  Compute the average delay by destination, then join on the airports data frame so you can show the spatial distribution of delays. Here’s an easy way to draw a map of the United States.  You are welcome to use this code or some other code. 

```{r}
library(tidyverse)
library(nycflights13)

airports <- airports
flights <- flights

airports %>%
  semi_join(flights, c("faa" = "dest")) %>%
  ggplot(aes(lon, lat)) +
  borders("state") +
  geom_point() +
  coord_quickmap()

```

```{r}
#Setting it up
avg_delays <- 
  flights %>%
  group_by(dest) %>%
  summarise(delay = mean(arr_delay, na.rm = TRUE)) %>%
  inner_join(airports, by = c(dest = "faa"))

#Plot
avg_delays %>%
  ggplot(aes(x= lon, y = lat)) +
  borders("state") +
  geom_point() +
  coord_quickmap()
```
  


You might want to use the size or colour of the points to display the average delay for each airport.

```{r}

flights
planes
airlines
airports
weather

#This is so I can view them by clicking on "data"
planes <- planes
flights <- flights
airlines <- airlines
airports <- airports
weather <- weather

avg_delays %>%
  ggplot(aes(lon, lat, colour = delay)) +
  borders("state") +
  geom_point() +
  coord_quickmap()
```


#### 2.   Do planes trade ownership?

You might expect that there’s an implicit relationship between plane and airline, because each plane is flown by a single airline. Confirm or reject this conjecture using data.

```{r}
#look for plane combos because the tailnum is unique for each plane
plane_combo <-
  flights %>%
  filter(!is.na(tailnum)) %>%
  distinct(tailnum, carrier)
#looking for if the tailum was lown for than one airline 
plane_combo %>%
  count(tailnum) %>%
  filter(1 < n) %>%
  nrow()
#So there are 17 planes that have flown for more than a single airline becasue the plane's tailnum appeared in more than 1 carried. This means that we can rejct this conjecture.
```

#### 3.  Plane's average speed.

Notice that ```flights$air_time``` is in minutes.  Make a new column that is the air time in hours. 

```{r}
hours = (flights$air_time)/60
flights$hour_air_time = hours
```

#### 4. Average speed

For each flight, compute the average speed of that flight (in miles per hour).  Then, for each plane, compute the average of those average speeds. Display it in a histogram. You can use a base R histogram ```hist``` or ggplot's ```geom_histogram```. 

```{r}
#adding a new column for mph
mph = (flights$distance/flights$hour_air_time)
flights$mph = mph
both = left_join(flights, planes, by = "tailnum")
flights$mph = mean(flights$mph)
ggplot(both, aes(mph)) +
  geom_histogram(mapping = aes(mph), data = both, position = "stack")
```



#### 5. What correlates with average speed?

To examine if there is anything in the plane data that correlates with average speed, use ```geom_boxplot``` with average speed of the plane (in previous question) on the y-axis and ```planes$engine``` on the x-axis.  Do the same for ```planes$engines``` and ```planes$type```.  

```{r}
ggplot(both, aes(mph, engine)) +
  geom_boxplot()

ggplot(both, aes(mph, type)) +
  geom_boxplot() 
  




```

PLEASE REMEMBER TO ALSO COMMIT AND PUSH YOUR FIGURES!!!
